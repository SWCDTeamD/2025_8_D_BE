---
alwaysApply: true
---
# [개발 원칙 및 고려사항]
* **비동기(Async/Await):** FastAPI의 핵심이므로 DB, LLM 호출 등 I/O 작업은 `async/await` 패턴을 사용합니다.
* **의존성 주입(Dependency Injection):** FastAPI `Depends`를 적극 활용하여 `db: Session`이나 서비스/리포지토리 인스턴스를 주입받습니다.
* **관심사의 분리:** 각 계층(router, service, repository)은 명확한 책임을 가집니다. `repositories`는 DB 조작에만, `services`는 비즈니스 로직에만, `routers`는 API 엔드포인트에만 집중합니다.
* **Pydantic 모델 활용:** API의 입/출력 데이터 유효성 검사 및 자동 문서화를 위해 `services` 내에서 Pydantic 모델을 정의하고 사용합니다.
* **보안:** SQL 인젝션 방지를 위해 SQLAlchemy ORM 기능 또는 매개변수 바인딩을 사용합니다 (동적 SQL `text()` 사용 시 특히 유의).
* **LLM 연동:** LangChain `Runnable` 인터페이스와 비동기(`ainvoke`)를 활용합니다.
* **점진적 개발:** 처음부터 완벽한 구조보다는 핵심 기능을 먼저 구현하고, 필요에 따라 점진적으로 확장합니다.

# [Cursor AI에게 기대하는 역할]
* 위 컨텍스트를 기반으로 코드를 이해하고 질문에 답변해 주세요.
* 새로운 기능을 추가하거나 기존 코드를 수정할 때, 이 아키텍처와 원칙을 준수하여 코드를 제안해 주세요.
* 특히 LangChain, SQLAlchemy, FastAPI의 비동기 연동에 대한 깊은 이해를 바탕으로 효율적이고 안전한 코드를 생성해 주세요.
* 필요한 경우, 코드의 개선 방안이나 잠재적 문제점을 제시해 주세요.